LIGGGHTS (Version LIGGGHTS-PUBLIC 3.7.0, compiled 2018-10-05-16:14:26 by mschramm, git commit d5ea2f3d8521af2be96bb31d9095e7bf22152ff0)
#### Writen for LIGGGHTS 3.7.0 with bond ##########################################################
#This script will show how to import a particle template into a simulation.



### Material Independent Properties
variable particle_diameter             equal 2.83e-3    # particles diameter in meters
variable bond_out_diameter             equal 2.83e-3    # fiber outer diameter in meters
variable bond_in_diameter              equal 0.0        # fiber inner diameter in meters
variable bond_length                   equal 2.83e-3    # distance, in meters, between two particles in bond
variable bond_damp_type                equal 3          # Use Global Force Damping
variable bond_damp_val                 equal 0.001      # NA
variable particle_density              equal 2500.0     # kg/m3
variable fiber_contact_youngs_modulus  equal 1.4e9      # Pa
variable wall_contact_youngs_modulus   equal 180.0e9    # Pa
variable bond_youngs_modulus           equal 1.4e9      # Pa
variable particle_poissons_ratio       equal 0.3        # NA
variable wall_poissons_ratio           equal 0.3        # NA
variable ke_tol                        equal 1.0e-5     # Energy that we will run the simulation to obtain
variable coef_res_pp                   equal 0.500      # particle-particle coefficient of restitution
variable coef_res_pw                   equal 0.300      # particle-wall coefficient of restitution
variable coef_res_ww                   equal 0.500      # wall-wall coefficient of restitution
variable coef_fri_pp                   equal 0.400      # particle-particle coefficient of friction
variable coef_fri_pw                   equal 0.600      # particle-wall coefficient of friction
variable coef_fri_ww                   equal 0.200      # wall-wall coefficient of friction

### Simulation Independent Parameters
variable fileprint_time                equal 1.0e-3  # how often we print to the file in seconds
variable thermo_time                   equal 1.0e-4  # how often we print to the screen in seconds
variable set_time                      equal 1.0e-3  # initial settiling time before we enter a loop

### Material Dependent Properties
variable particle_radius               equal 0.5*${particle_diameter}
variable particle_radius               equal 0.5*0.00283
variable bond_shear_modulus            equal ${bond_youngs_modulus}/(2.0*(1.0+${particle_poissons_ratio}))
variable bond_shear_modulus            equal 1400000000/(2.0*(1.0+${particle_poissons_ratio}))
variable bond_shear_modulus            equal 1400000000/(2.0*(1.0+0.3))
variable bond_out_per                  equal ${bond_out_diameter}/${particle_diameter}
variable bond_out_per                  equal 0.00283/${particle_diameter}
variable bond_out_per                  equal 0.00283/0.00283
variable bond_in_per                   equal ${bond_in_diameter}/${particle_diameter}
variable bond_in_per                   equal 0/${particle_diameter}
variable bond_in_per                   equal 0/0.00283

### Calculate dt using the bond model
variable r2                            equal ${particle_radius}*${particle_radius}
variable r2                            equal 0.001415*${particle_radius}
variable r2                            equal 0.001415*0.001415
variable r3                            equal ${r2}*${particle_radius}
variable r3                            equal 2.002225e-06*${particle_radius}
variable r3                            equal 2.002225e-06*0.001415
variable K                             equal ${bond_youngs_modulus}*PI*${r2}/${bond_length}
variable K                             equal 1400000000*PI*${r2}/${bond_length}
variable K                             equal 1400000000*PI*2.002225e-06/${bond_length}
variable K                             equal 1400000000*PI*2.002225e-06/0.00283
variable m                             equal 4.0*PI*${r3}*${particle_density}/3.0
variable m                             equal 4.0*PI*2.833148375e-09*${particle_density}/3.0
variable m                             equal 4.0*PI*2.833148375e-09*2500/3.0
variable w                             equal sqrt($K/$m)
variable w                             equal sqrt(3111747.52338069/$m)
variable w                             equal sqrt(3111747.52338069/2.96686604047662e-05)
variable dt                            equal 0.95/$w
variable dt                            equal 0.95/323856.939572851

### Simulation Dependent Parameters
variable fileprint_step                equal ceil(${fileprint_time}/${dt})
variable fileprint_step                equal ceil(0.001/${dt})
variable fileprint_step                equal ceil(0.001/2.93339398949733e-06)
variable thermo_step                   equal ceil(${thermo_time}/${dt})
variable thermo_step                   equal ceil(0.0001/${dt})
variable thermo_step                   equal ceil(0.0001/2.93339398949733e-06)
variable set_step                      equal ceil(${set_time}/${dt})
variable set_step                      equal ceil(0.001/${dt})
variable set_step                      equal ceil(0.001/2.93339398949733e-06)


### Build Simulation
# Specify what we are simulating
atom_style hybrid granular bond/gran n_bondtypes 1 bonds_per_atom 6
atom_modify map array
hard_particles yes # <- Needed because of the high Youngs modulus

# Fixed boundary conditions
boundary f f f

# newton off is needed due to the tangential history contact model
newton off
communicate single vel yes
units si

# Create the domain arround the drum that will be imported
region        domain block -0.2 0.2 -0.2 0.2 -0.01 0.25 units box
# Create the simulation domain with two material types
create_box    2 domain
Created orthogonal box = (-0.2 -0.2 -0.01) to (0.2 0.2 0.25)
  1 by 1 by 1 MPI processor grid

# Use hertz-mindeln contact model
pair_style gran model hertz tangential history
# Use the stiff granular bond model
bond_style gran
WARNING: Bond granular: This is a beta version - be careful! (../bond_gran.cpp:97)

# Set neighbor bin sizes and update after each run step if needed
neighbor      0.001 bin
neigh_modify delay 0

## Set coefficients for contact and bond model
# For the contact model, we do not need to set anything
pair_coeff * *
# Set coefficients for bond model
bond_coeff 1 ${bond_out_per} ${bond_in_per} ${bond_youngs_modulus} ${bond_shear_modulus} ${bond_damp_type} ${bond_damp_val} 1 1.0e32 1.0e32
bond_coeff 1 1 ${bond_in_per} ${bond_youngs_modulus} ${bond_shear_modulus} ${bond_damp_type} ${bond_damp_val} 1 1.0e32 1.0e32
bond_coeff 1 1 0 ${bond_youngs_modulus} ${bond_shear_modulus} ${bond_damp_type} ${bond_damp_val} 1 1.0e32 1.0e32
bond_coeff 1 1 0 1400000000 ${bond_shear_modulus} ${bond_damp_type} ${bond_damp_val} 1 1.0e32 1.0e32
bond_coeff 1 1 0 1400000000 538461538.461538 ${bond_damp_type} ${bond_damp_val} 1 1.0e32 1.0e32
bond_coeff 1 1 0 1400000000 538461538.461538 3 ${bond_damp_val} 1 1.0e32 1.0e32
bond_coeff 1 1 0 1400000000 538461538.461538 3 0.001 1 1.0e32 1.0e32


## Set material properties for fiber and wall
fix m1 all property/global youngsModulus peratomtype ${fiber_contact_youngs_modulus} ${wall_contact_youngs_modulus}
fix m1 all property/global youngsModulus peratomtype 1400000000 ${wall_contact_youngs_modulus}
fix m1 all property/global youngsModulus peratomtype 1400000000 180000000000
fix m2 all property/global poissonsRatio peratomtype ${particle_poissons_ratio} ${wall_poissons_ratio}
fix m2 all property/global poissonsRatio peratomtype 0.3 ${wall_poissons_ratio}
fix m2 all property/global poissonsRatio peratomtype 0.3 0.3
fix m3 all property/global coefficientRestitution peratomtypepair 2 ${coef_res_pp} ${coef_res_pw}                                                                     ${coef_res_pw} ${coef_res_ww}
fix m3 all property/global coefficientRestitution peratomtypepair 2 0.5 ${coef_res_pw}                                                                     ${coef_res_pw} ${coef_res_ww}
fix m3 all property/global coefficientRestitution peratomtypepair 2 0.5 0.3                                                                     ${coef_res_pw} ${coef_res_ww}
fix m3 all property/global coefficientRestitution peratomtypepair 2 0.5 0.3                                                                     0.3 ${coef_res_ww}
fix m3 all property/global coefficientRestitution peratomtypepair 2 0.5 0.3                                                                     0.3 0.5

fix m4 all property/global coefficientFriction peratomtypepair 2 ${coef_fri_pp} ${coef_fri_pw}                                                                  ${coef_fri_pw} ${coef_fri_ww}
fix m4 all property/global coefficientFriction peratomtypepair 2 0.4 ${coef_fri_pw}                                                                  ${coef_fri_pw} ${coef_fri_ww}
fix m4 all property/global coefficientFriction peratomtypepair 2 0.4 0.6                                                                  ${coef_fri_pw} ${coef_fri_ww}
fix m4 all property/global coefficientFriction peratomtypepair 2 0.4 0.6                                                                  0.6 ${coef_fri_ww}
fix m4 all property/global coefficientFriction peratomtypepair 2 0.4 0.6                                                                  0.6 0.2

## Insert the geometry for the simulation
# Load in the stl file of a container and make it interactable
fix Drum all mesh/surface/stress file Drum.STL type 2 scale 0.001 move 0.0 0.0 0.0
fix wall all wall/gran model hertz tangential history mesh n_meshes 1 meshes Drum
# Create a thin infinitly large plane in the x plain at a height of 0.15 meters
fix w1 all wall/gran model hertz tangential history primitive type 2 zplane 0.15

## Construct the template for a fiber
# This cannot be automated (beside reading in a file with the same info), and must be changed by hand.
# This function IS part of LIGGGHTS but is NOT documented
fix  pts1 all particletemplate/multiplespheres 15485863 atom_type 1 density constant ${particle_density} nspheres 21 ntry 50000 spheres 0.00000 0.0 0.0 0.001415 0.00283 0.0 0.0 0.001415 0.00566 0.0 0.0 0.001415 0.00849 0.0 0.0 0.001415 0.01132 0.0 0.0 0.001415 0.01415 0.0 0.0 0.001415 0.01698 0.0 0.0 0.001415 0.01981 0.0 0.0 0.001415 0.02264 0.0 0.0 0.001415 0.02547 0.0 0.0 0.001415 0.02830 0.0 0.0 0.001415 0.03113 0.0 0.0 0.001415 0.03396 0.0 0.0 0.001415 0.03679 0.0 0.0 0.001415 0.03962 0.0 0.0 0.001415 0.04245 0.0 0.0 0.001415 0.04528 0.0 0.0 0.001415 0.04811 0.0 0.0 0.001415 0.05094 0.0 0.0 0.001415 0.05377 0.0 0.0 0.001415 0.05660 0.0 0.0 0.001415 bonded yes
fix  pts1 all particletemplate/multiplespheres 15485863 atom_type 1 density constant 2500 nspheres 21 ntry 50000 spheres 0.00000 0.0 0.0 0.001415 0.00283 0.0 0.0 0.001415 0.00566 0.0 0.0 0.001415 0.00849 0.0 0.0 0.001415 0.01132 0.0 0.0 0.001415 0.01415 0.0 0.0 0.001415 0.01698 0.0 0.0 0.001415 0.01981 0.0 0.0 0.001415 0.02264 0.0 0.0 0.001415 0.02547 0.0 0.0 0.001415 0.02830 0.0 0.0 0.001415 0.03113 0.0 0.0 0.001415 0.03396 0.0 0.0 0.001415 0.03679 0.0 0.0 0.001415 0.03962 0.0 0.0 0.001415 0.04245 0.0 0.0 0.001415 0.04528 0.0 0.0 0.001415 0.04811 0.0 0.0 0.001415 0.05094 0.0 0.0 0.001415 0.05377 0.0 0.0 0.001415 0.05660 0.0 0.0 0.001415 bonded yes
WARNING: fix particletemplate/multisphere: ntry is very low (../fix_template_multiplespheres.cpp:229)
Finished calculating properties of template
   mass = 6.212346e-04, radius of bounding sphere = 2.971500e-02, radius of equivalent sphere = 3.900099e-03
   center of mass = 0.000000e+00, 0.000000e+00, 0.000000e+00
   center of bounding sphere in global coords = 6.152596e-05, -4.129381e-06, 4.700540e-06

# Set the probability that a template will be used
fix  pdd1 all particledistribution/discrete 32452843 1 pts1 1.0

#region and insertion
group  nve_group region domain
0 atoms in group nve_group
region bc cylinder z 0.0 0.0 0.110 0.00143 0.1 units box

#particle insertion
fix ins nve_group insert/pack seed 32452867 distributiontemplate pdd1     maxattempt 100 insert_every once overlapcheck yes orientation random     all_in yes vel constant 0.0 0.0 -1.0 region bc particles_in_region 2500     ntry_mc 10000 do_dense_pack no

fix grav all gravity 9.81 vector 0.0 0.0 -1.0

fix integr all nve/sphere

timestep ${dt}
timestep 2.93339398949733e-06
print "dt = ${dt}"
dt = 2.93339398949733e-06

## Insert all of the particles
run 1
Setting up run at Wed Oct 17 14:06:51 2018

INFO: Particle insertion ins: inserting every 0 steps
Memory usage per processor = 31.332 Mbytes
    Step    Atoms         KinEng            CPU 
       0        0              0              0 
INFO: Particle insertion ins: inserted 604 particle templates (mass 3.752257e-01) at step 1
 - a total of 604 particle templates (mass 3.752257e-01) inserted so far.
WARNING: Particle insertion: Less insertions than requested (../fix_insert.cpp:814)
       1    12684     0.18816406     0.54323712 
Loop time of 0.543252 on 1 procs for 1 steps with 12684 atoms, finish time Wed Oct 17 14:06:52 2018


Pair  time (%) = 0.00122394 (0.225299)
Bond  time (%) = 5.08036e-07 (9.35176e-05)
Neigh time (%) = 0.0107696 (1.98243)
Comm  time (%) = 8.26239e-05 (0.0152091)
Outpt time (%) = 6.73551e-05 (0.0123985)
Other time (%) = 0.531108 (97.7646)

Nlocal:    12684 ave 12684 max 12684 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    14803 ave 14803 max 14803 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14803
Ave neighs/atom = 1.16706
Ave special neighs/atom = 0
Neighbor list builds = 1
Dangerous builds = 0

## Bond Particles together
# Define the bond radius to determine if two particle become bonded together
variable bond_skin equal 1.000001*${particle_diameter}
variable bond_skin equal 1.000001*0.00283
# Define a bond of type bond_1 between atom types atom_a and atom_b every n_step steps
variable bond_1 equal 1
variable atom_a equal 1
variable atom_b equal 1
variable n_step equal 1
fix bondcr all bond/create/gran ${n_step} ${atom_a} ${atom_b} ${bond_skin} ${bond_1} 6
fix bondcr all bond/create/gran 1 ${atom_a} ${atom_b} ${bond_skin} ${bond_1} 6
fix bondcr all bond/create/gran 1 1 ${atom_b} ${bond_skin} ${bond_1} 6
fix bondcr all bond/create/gran 1 1 1 ${bond_skin} ${bond_1} 6
fix bondcr all bond/create/gran 1 1 1 0.00283000283 ${bond_1} 6
fix bondcr all bond/create/gran 1 1 1 0.00283000283 1 6
# Find potential bonds
run 1
Setting up run at Wed Oct 17 14:06:52 2018

Memory usage per processor = 42.038 Mbytes
    Step    Atoms         KinEng            CPU 
       1    12684     0.18816406              0 
       2    12684     0.18817489    0.041042976 
Loop time of 0.0410581 on 1 procs for 1 steps with 12684 atoms, finish time Wed Oct 17 14:06:52 2018


Pair  time (%) = 0.0015797 (3.84749)
Bond  time (%) = 0.00186343 (4.53852)
Neigh time (%) = 0.0233491 (56.8686)
Comm  time (%) = 0.0001014 (0.246968)
Outpt time (%) = 6.60659e-05 (0.160909)
Other time (%) = 0.0140983 (34.3375)

Nlocal:    12684 ave 12684 max 12684 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:    0 ave 0 max 0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:    14803 ave 14803 max 14803 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 14803
Ave neighs/atom = 1.16706
Ave special neighs/atom = 0
Neighbor list builds = 1
Dangerous builds = 0
# Do not create new bonds after this line
fix_modify bondcr every 0

## Set screen output
# Track the max height of the particles
compute max_height all reduce max z
variable max_h equal c_max_height
# Track the kinetic energy in the system
variable my_ke equal ke
# Keep track of the time in the simulation
variable sim_time equal step*${dt}
variable sim_time equal step*2.93339398949733e-06
# Set the output to the screen to show the current simulation step, number of atoms, number of bonds, the simulation time,
# the ammount of time that has passed since the start of the run, the estimated remaining time to finish the current run,
# the kinetic energy of the domain, and the max height of all particles
thermo_style custom step atoms numbond v_sim_time cpu cpuremain ke v_max_h
# Set how often the simulation outputs to the screen
thermo ${thermo_step}
thermo 35
# Ignore particles that leave the domain and do NOT noramlize the data
thermo_modify lost ignore norm no

# Wrtie particle locations to file
dump dmp all custom ${fileprint_step} post/dump*.liggghts id type x y z ix iy iz vx vy vz fx fy fz omegax omegay omegaz radius
dump dmp all custom 341 post/dump*.liggghts id type x y z ix iy iz vx vy vz fx fy fz omegax omegay omegaz radius

# Wrtie geometry location to file
dump stldrm all mesh/vtk ${fileprint_step} post/stl_drum*.vtk stress stresscomponents Drum
dump stldrm all mesh/vtk 341 post/stl_drum*.vtk stress stresscomponents Drum

# Run until we get the kinetic energy below our set tolerance
label begin_set_loop # Start of the loop
    run ${set_step} pre no post no # Run so many steps until we check the KE again
    run 341 pre no post no 
    Step    Atoms  numbond       sim_time            CPU        CPULeft         KinEng          max_h 
       2    12684    12080   5.866788e-06              0              0     0.18817489    0.097643921 
      35    12684    12080  0.00010266879     0.11755874      1.0972207     0.18853243    0.097547069 
      70    12684    12080  0.00020533758     0.23674528     0.95046467     0.18891202    0.097444246 
     105    12684    12080  0.00030800637       0.355385     0.82118224     0.18929199     0.09734132 
     140    12684    12080  0.00041067516     0.47577505     0.69987272     0.18967234    0.097238291 
     175    12684    12080  0.00051334395     0.67220002     0.65277292     0.19005307    0.097135158 
     210    12684    12080  0.00061601274     0.79517419     0.50845309     0.19043419    0.097031922 
     245    12684    12080  0.00071868153     0.91251718     0.36801123     0.19081568    0.096928583 
     280    12684    12080  0.00082135032      1.0299318     0.23340193     0.19119756     0.09682514 
     315    12684    12080  0.00092401911      1.1472235     0.10262707     0.19157982    0.096721594 
     343    12684    12080   0.0010061541      1.3407218              0      0.1918859    0.096638682 
Loop time of 1.3408 on 1 procs for 341 steps with 12684 atoms, finish time Wed Oct 17 14:06:53 2018

    if "${my_ke}<${ke_tol}" then         "jump in.liggghts end_set_loop"     else         "jump in.liggghts begin_set_loop"
jump in.liggghts begin_set_loop
    run ${set_step} pre no post no # Run so many steps until we check the KE again
    run 341 pre no post no 
    Step    Atoms  numbond       sim_time            CPU        CPULeft         KinEng          max_h 
     343    12684    12080   0.0010061541              0              0      0.1918859    0.096638682 
     350    12684    12080   0.0010266879    0.024636592       1.175542     0.19196246    0.096617944 
     385    12684    12080   0.0011293567     0.14857376       1.057707     0.19234548    0.096514191 
     420    12684    12080   0.0012320255     0.26868763     0.92121633     0.19272888    0.096410335 
     455    12684    12080   0.0013346943     0.38908898     0.79554885     0.19311267    0.096306375 
     490    12684    12080   0.0014373631     0.51240053        0.67623     0.19349684    0.096202311 
     525    12684    12080   0.0015400318     0.70683454      0.6175097     0.19388139    0.096098145 
     560    12684    12080   0.0016427006     0.82384691     0.47076994     0.19426632    0.095993875 
     595    12684    12080   0.0017453694     0.94502948      0.3337606     0.19465163    0.095889501 
     630    12684    12080   0.0018480382      1.0658363     0.20054074     0.19503733    0.095785024 
     665    12684    12080    0.001950707      1.1890085     0.07015892      0.1954234    0.095680444 
     684    12684    12080   0.0020064415      1.3494122              0     0.19563315    0.095623628 
Loop time of 1.34949 on 1 procs for 341 steps with 12684 atoms, finish time Wed Oct 17 14:06:54 2018

    if "${my_ke}<${ke_tol}" then         "jump in.liggghts end_set_loop"     else         "jump in.liggghts begin_set_loop"
jump in.liggghts begin_set_loop
    run ${set_step} pre no post no # Run so many steps until we check the KE again
    run 341 pre no post no 
    Step    Atoms  numbond       sim_time            CPU        CPULeft         KinEng          max_h 
     684    12684    12080   0.0020064415              0              0     0.19563315    0.095623628 
     700    12684    12080   0.0020533758    0.058388935      1.1860361     0.19580986     0.09557576 
     735    12684    12080   0.0021560446      0.1790036      1.0178665      0.1961967    0.095470973 
     770    12684    12080   0.0022587134     0.29750662     0.88214304     0.19633501    0.095366082 
     805    12684    12080   0.0023613822     0.41554163     0.75553099     0.19686372    0.095261089 
     840    12684    12080    0.002464051     0.53365756     0.63286365     0.19706905    0.095155991 
     875    12684    12080   0.0025667197      0.7221372     0.56712413     0.19758171     0.09505079 
     910    12684    12080   0.0026693885     0.84350854     0.42921922     0.19795655    0.094945486 
     945    12684    12080   0.0027720573     0.96647853     0.29623875     0.19834783    0.094840079 
     980    12684    12080   0.0028747261      1.0889057     0.16554318      0.1986749    0.094734568 
    1015    12684    12080   0.0029773949      1.2527416    0.037847197     0.19867131    0.094628953 
    1025    12684    12080   0.0030067288      1.3501831              0     0.19875045    0.094598759 
Loop time of 1.35026 on 1 procs for 341 steps with 12684 atoms, finish time Wed Oct 17 14:06:56 2018

    if "${my_ke}<${ke_tol}" then         "jump in.liggghts end_set_loop"     else         "jump in.liggghts begin_set_loop"
jump in.liggghts begin_set_loop
    run ${set_step} pre no post no # Run so many steps until we check the KE again
    run 341 pre no post no 
    Step    Atoms  numbond       sim_time            CPU        CPULeft         KinEng          max_h 
    1025    12684    12080   0.0030067288              0              0     0.19875045    0.094598759 
    1050    12684    12080   0.0030800637    0.086270666      1.0904677     0.19906049    0.094523236 
    1085    12684    12080   0.0031827325     0.20360298     0.95354301     0.19942482    0.094417414 
    1120    12684    12080   0.0032854013     0.32235369     0.83472752     0.19965373     0.09431149 
    1155    12684    12080   0.0033880701     0.44139522     0.71641899      0.1999801    0.094205462 
    1190    12684    12080   0.0034907388     0.63234105     0.67449765     0.20036436     0.09409933 
    1225    12684    12080   0.0035934076     0.75654557     0.53336497     0.20072024    0.093993095 
    1260    12684    12080   0.0036960764      0.8771695     0.39565967     0.20080975    0.093886757 
    1295    12684    12080   0.0037987452      1.0279755     0.27031965     0.20138604    0.093780316 
    1330    12684    12080    0.003901414      1.1466179     0.13533856     0.20155169    0.093673771 
    1365    12684    12080   0.0040040828      1.3253352   0.0038980463     0.20197604    0.093567122 
    1366    12684    12080   0.0040070162        1.32888              0     0.20198944    0.093564074 
Loop time of 1.32895 on 1 procs for 341 steps with 12684 atoms, finish time Wed Oct 17 14:06:57 2018

    if "${my_ke}<${ke_tol}" then         "jump in.liggghts end_set_loop"     else         "jump in.liggghts begin_set_loop"
jump in.liggghts begin_set_loop
    run ${set_step} pre no post no # Run so many steps until we check the KE again
    run 341 pre no post no 
    Step    Atoms  numbond       sim_time            CPU        CPULeft         KinEng          max_h 
    1366    12684    12080   0.0040070162              0              0     0.20198944    0.093564074 
    1400    12684    12080   0.0041067516     0.11891447      1.0737327     0.20230808     0.09346037 
    1435    12684    12080   0.0042094204     0.31413268      1.2383222     0.20265441    0.093353515 
    1470    12684    12080   0.0043120892     0.43571224     0.99292217     0.20302074    0.093246556 
    1505    12684    12080    0.004414758     0.55789517     0.81075485     0.20337092    0.093139494 
    1540    12684    12080   0.0045174267     0.68009827     0.65273847     0.20346967    0.093032329 
    1575    12684    12080   0.0046200955     0.80139795     0.50614639     0.20405942     0.09292506 
    1610    12684    12080   0.0047227643     0.95317329     0.37892567     0.20443481    0.092817688 
    1645    12684    12080   0.0048254331      1.0731038     0.23846762     0.20442993    0.092710212 
    1680    12684    12080   0.0049281019      1.1971113     0.10293636     0.20450543    0.092602633 
    1707    12684    12080   0.0050073035      1.3563036              0     0.20487509    0.092519573 
Loop time of 1.35638 on 1 procs for 341 steps with 12684 atoms, finish time Wed Oct 17 14:06:58 2018

    if "${my_ke}<${ke_tol}" then         "jump in.liggghts end_set_loop"     else         "jump in.liggghts begin_set_loop"
jump in.liggghts begin_set_loop
    run ${set_step} pre no post no # Run so many steps until we check the KE again
    run 341 pre no post no 
    Step    Atoms  numbond       sim_time            CPU        CPULeft         KinEng          max_h 
    1707    12684    12080   0.0050073035              0              0     0.20487509    0.092519573 
    1715    12684    12080   0.0050307707     0.10359307      4.3120862     0.20496914     0.09249495 
    1750    12684    12080   0.0051334395     0.22716336       1.574298     0.20506774    0.092387164 
    1785    12684    12080   0.0052361083     0.38250089      1.2897163     0.20555808    0.092279275 
    1820    12684    12080   0.0053387771     0.50351358      1.0159399     0.20591153    0.092171282 
    1855    12684    12080   0.0054414459     0.62467158     0.81460608     0.20618982    0.092063186 
    1890    12684    12080   0.0055441146     0.74717355     0.64510115     0.20643577    0.091954987 
    1925    12684    12080   0.0056467834     0.86838218     0.48995899     0.20659804    0.091846684 
    1960    12684    12080   0.0057494522       1.024793     0.35644998     0.20687569    0.091738277 
    1995    12684    12080    0.005852121      1.1478096     0.21122898     0.20694286    0.091629768 
    2030    12684    12080   0.0059547898      1.2704168    0.070797251     0.20745076    0.091521155 
    2048    12684    12080   0.0060075909       1.396387              0     0.20757172    0.091465256 
Loop time of 1.39646 on 1 procs for 341 steps with 12684 atoms, finish time Wed Oct 17 14:07:00 2018

    if "${my_ke}<${ke_tol}" then         "jump in.liggghts end_set_loop"     else         "jump in.liggghts begin_set_loop"
jump in.liggghts begin_set_loop
    run ${set_step} pre no post no # Run so many steps until we check the KE again
    run 341 pre no post no 
    Step    Atoms  numbond       sim_time            CPU        CPULeft         KinEng          max_h 
    2048    12684    12080   0.0060075909              0              0     0.20757172    0.091465256 
    2065    12684    12080   0.0060574586    0.059671928      1.1372869     0.20766591    0.091412438 
    2100    12684    12080   0.0061601274     0.26225728      1.4575478     0.20804672    0.091303618 
    2135    12684    12080   0.0062627962     0.38806807      1.1329819     0.20810373    0.091194695 
    2170    12684    12080    0.006365465     0.51301991      0.9209141     0.20817721    0.091085668 
    2205    12684    12080   0.0064681337     0.66970656     0.78487963     0.20824324    0.090976538 
    2240    12684    12080   0.0065708025     0.79300055     0.61540183       0.207746    0.090867304 
    2275    12684    12080   0.0066734713     0.91448253     0.45925578     0.20789737    0.090757967 
    2310    12684    12080   0.0067761401       1.067657     0.32192729     0.20806477    0.090648527 
    2345    12684    12080   0.0068788089      1.1895948     0.17623634     0.20817038    0.090538983 
    2380    12684    12080   0.0069814777      1.3109641    0.035538197     0.20852497    0.090429336 
    2389    12684    12080   0.0070078782      1.4069868              0     0.20865748    0.090401124 
Loop time of 1.40706 on 1 procs for 341 steps with 12684 atoms, finish time Wed Oct 17 14:07:01 2018

    if "${my_ke}<${ke_tol}" then         "jump in.liggghts end_set_loop"     else         "jump in.liggghts begin_set_loop"
jump in.liggghts begin_set_loop
    run ${set_step} pre no post no # Run so many steps until we check the KE again
    run 341 pre no post no 
    Step    Atoms  numbond       sim_time            CPU        CPULeft         KinEng          max_h 
    2389    12684    12080   0.0070078782              0              0     0.20865748    0.090401124 
    2415    12684    12080   0.0070841465     0.16376892      1.9841301     0.20885341    0.090319585 
    2450    12684    12080   0.0071868153     0.29029934       1.332524     0.20881757    0.090209731 
    2485    12684    12080   0.0072894841     0.41231055      1.0522522     0.20866789    0.090099774 
    2520    12684    12080   0.0073921529     0.56565791     0.90678064     0.20836497    0.089989713 
    2555    12684    12080   0.0074948216     0.68722831     0.72448815     0.20878633    0.089879548 
    2590    12684    12080   0.0075974904     0.80909507     0.56354913     0.20827284    0.089769281 
    2625    12684    12080   0.0077001592     0.96307298     0.42848607     0.20856021     0.08965891 
    2660    12684    12080    0.007802828      1.0821179     0.27951402      0.2084664    0.089548435 
    2695    12684    12080   0.0079054968      1.2337818     0.14111891     0.20909646    0.089437857 
    2730    12684    12080   0.0080081656      1.4193595              0     0.20898161    0.089327176 
Loop time of 1.41943 on 1 procs for 341 steps with 12684 atoms, finish time Wed Oct 17 14:07:03 2018

    if "${my_ke}<${ke_tol}" then         "jump in.liggghts end_set_loop"     else         "jump in.liggghts begin_set_loop"
jump in.liggghts begin_set_loop
    run ${set_step} pre no post no # Run so many steps until we check the KE again
    run 341 pre no post no 
    Step    Atoms  numbond       sim_time            CPU        CPULeft         KinEng          max_h 
    2730    12684    12080   0.0080081656              0              0     0.20898161    0.089327176 
    2765    12684    12080   0.0081108344     0.19447162      1.7002425     0.20856381    0.089216391 
    2800    12684    12080   0.0082135032     0.31340994      1.2133462     0.20924032    0.089105503 
    2835    12684    12080    0.008316172     0.46337576      1.0414932     0.20911668    0.088994512 
    2870    12684    12080   0.0084188407     0.58390116     0.83831586     0.20879673    0.088883417 
    2905    12684    12080   0.0085215095     0.73658869     0.69870744      0.2093496    0.088772219 
    2940    12684    12080   0.0086241783     0.86005283     0.53650946     0.20935883    0.088661342 
    2975    12684    12080   0.0087268471     0.98065796       0.384258     0.20951967    0.088552857 
    3010    12684    12080   0.0088295159      1.1291055     0.24598383      0.2089801    0.088443557 
    3045    12684    12080   0.0089321847      1.2485357     0.10305379     0.20894806    0.088334671 
    3071    12684    12080   0.0090084529      1.4012326              0     0.20907335    0.088253248 
Loop time of 1.4013 on 1 procs for 341 steps with 12684 atoms, finish time Wed Oct 17 14:07:04 2018

    if "${my_ke}<${ke_tol}" then         "jump in.liggghts end_set_loop"     else         "jump in.liggghts begin_set_loop"
jump in.liggghts begin_set_loop
    run ${set_step} pre no post no # Run so many steps until we check the KE again
    run 341 pre no post no 
    Step    Atoms  numbond       sim_time            CPU        CPULeft         KinEng          max_h 
    3071    12684    12080   0.0090084529              0              0     0.20907335    0.088253248 
    3080    12684    12080   0.0090348535    0.031326419       1.155615     0.20900149    0.088225842 
    3115    12684    12080   0.0091375223      0.2351318       1.587143     0.20853871    0.088117821 
    3150    12684    12080   0.0092401911     0.35472076      1.1764174     0.20858256    0.088011651 
    3185    12684    12080   0.0093428599     0.51085473      1.0172292     0.20808112     0.08790394 
    3220    12684    12080   0.0094455286     0.63403618     0.81701366     0.20791028    0.087803423 
    3255    12684    12080   0.0095481974     0.75633735     0.64535343     0.20783313     0.08772092 
    3290    12684    12080   0.0096508662     0.90956699     0.50669971     0.20774458     0.08764429 
    3325    12684    12080    0.009753535      1.0319531     0.35346442     0.20735975    0.087571239 
    3360    12684    12080   0.0098562038      1.1850975     0.21323564         0.2077     0.08749767 
    3395    12684    12080   0.0099588726      1.3070117    0.068577802      0.2071392      0.0874239 
    3412    12684    12080     0.01000874      1.4314151              0     0.20724001    0.087389933 
Loop time of 1.4315 on 1 procs for 341 steps with 12684 atoms, finish time Wed Oct 17 14:07:05 2018

    if "${my_ke}<${ke_tol}" then         "jump in.liggghts end_set_loop"     else         "jump in.liggghts begin_set_loop"
jump in.liggghts begin_set_loop
    run ${set_step} pre no post no # Run so many steps until we check the KE again
    run 341 pre no post no 
    Step    Atoms  numbond       sim_time            CPU        CPULeft         KinEng          max_h 
    3412    12684    12080     0.01000874              0              0     0.20724001    0.087389933 
    3430    12684    12080    0.010061541     0.06498003      1.1660408     0.20726023    0.087352678 
    3465    12684    12080     0.01016421     0.18612642      1.0114066     0.20767666    0.087280882 
    3500    12684    12080    0.010266879     0.37834575      1.0877457     0.20752774    0.087208186 
    3535    12684    12080    0.010369548     0.49838867     0.88332384     0.20724969    0.087138002 
    3570    12684    12080    0.010472217     0.64987663     0.75270607      0.2074632    0.087065878 
    3605    12684    12080    0.010574885     0.77186041      0.5918934     0.20691421     0.08699733 
    3640    12684    12080    0.010677554     0.89600195     0.44407141     0.20694235    0.086928385 
    3675    12684    12080    0.010780223      1.0538524     0.31254959     0.20712079    0.086855467 
    3710    12684    12080    0.010882892      1.1776678       0.169932       0.206699    0.086784462 
    3745    12684    12080     0.01098556      1.3345952    0.032062363     0.20637669    0.086712505 
WARNING: Forced restart written (../output.cpp:427)
    3752    12684    12080    0.011006094      1.4653456   0.0043098418     0.20646052    0.086699522 
Loop time of 1.46542 on 1 procs for 341 steps with 12684 atoms, finish time Wed Oct 17 14:07:07 2018

